<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Organic Finder</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        body { font-family: sans-serif; margin: 0; display: flex; flex-direction: column; height: 100vh; }
        header { background: #1b5e20; color: white; padding: 15px; text-align: center; font-size: 1.2rem; font-weight: bold; }
        #map { flex-grow: 1; width: 100%; }
        .ui-area { padding: 20px; background: white; text-align: center; border-top: 1px solid #ddd; }
        button { background: #f39c12; color: white; border: none; padding: 15px 30px; border-radius: 5px; font-weight: bold; font-size: 1.1rem; cursor: pointer; width: 100%; max-width: 300px; }
        #debug-msg { color: #2e7d32; font-size: 0.9rem; margin-top: 10px; font-weight: bold; }
    </style>
</head>
<body>

<header>ğŸŒ¿ Organic Finder</header>
<div id="map"></div>
<div class="ui-area">
    <button onclick="updateLocation()">ğŸ“ ç¾åœ¨åœ°å‘¨è¾ºã‚’ã‚¹ã‚­ãƒ£ãƒ³</button>
    <div id="debug-msg">ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã‚¹ã‚­ãƒ£ãƒ³é–‹å§‹</div>
</div>

<script>
    // åˆæœŸè¡¨ç¤º
    const map = L.map('map').setView([35.0, 135.0], 5);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

    function updateLocation() {
        const debug = document.getElementById('debug-msg');
        debug.innerText = "ç¾åœ¨åœ°ã‚’ç‰¹å®šä¸­...";

        navigator.geolocation.getCurrentPosition((pos) => {
            const { latitude, longitude } = pos.coords;
            map.setView([latitude, longitude], 15);
            
            // ç¾åœ¨åœ°ãƒãƒ¼ã‚«ãƒ¼
            L.marker([latitude, longitude]).addTo(map).bindPopup("ã‚ãªãŸã®ç¾åœ¨åœ°").openPopup();
            
            debug.innerText = "è¿‘éš£ã®æœ‰æ©Ÿã‚·ãƒ§ãƒƒãƒ—ã‚’æ¤œç´¢ä¸­...";

            // å‘¨è¾º5kmã®åº—èˆ—æ¤œç´¢ï¼ˆOpenStreetMap APIï¼‰
            const query = `[out:json];node["shop"~"organic|health_food"]
